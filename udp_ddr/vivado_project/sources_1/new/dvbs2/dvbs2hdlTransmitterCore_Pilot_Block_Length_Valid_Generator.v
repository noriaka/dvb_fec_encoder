// -------------------------------------------------------------
// 
// File Name: F:\FileFolder\DVB\dvbs2_tx_new\hdlsrc\dvbs2hdlTransmitter\dvbs2hdlTransmitterCore\dvbs2hdlTransmitterCore_Pilot_Block_Length_Valid_Generator.v
// Created: 2024-01-10 13:49:59
// 
// Generated by MATLAB 23.2, HDL Coder 23.2, and Simulink 23.2
// 
// -------------------------------------------------------------


// -------------------------------------------------------------
// 
// Module: dvbs2hdlTransmitterCore_Pilot_Block_Length_Valid_Generator
// Source Path: dvbs2hdlTransmitterCore/DVB-S2 Tx/PL Frame Generator/RAM FIFO/Pilot Generator/Pilot Block Length 
// Valid Generato
// Hierarchy Level: 6
// Model version: 4.5
// 
// -------------------------------------------------------------

`timescale 1 ns / 1 ns

module dvbs2hdlTransmitterCore_Pilot_Block_Length_Valid_Generator
          (clk,
           reset,
           enb_1_8_0,
           trigger,
           endOutm1,
           validOut);


  input   clk;
  input   reset;
  input   enb_1_8_0;
  input   trigger;
  output  endOutm1;
  output  validOut;


  wire stateControl_1;
  reg  [1:0] delayMatch_reg;  // ufix1 [2]
  wire stateControl_2;
  wire enb_1_8_0_gated;
  reg  endOut;
  reg  endOutm1_1;
  reg  validOut_1;
  reg [5:0] count;  // ufix6
  reg  countActive;
  reg  countEnd;
  reg  countEndm1;
  reg [5:0] count_next;  // ufix6
  reg  countActive_next;
  reg  countEnd_next;
  reg  countEndm1_next;
  wire endOutm1_bypass;
  reg  endOutm1_last_value;
  wire validOut_bypass;
  reg  validOut_last_value;
  reg [5:0] count_temp;  // ufix6
  reg [6:0] add_temp;  // ufix7
  reg [6:0] t_0;  // ufix7


  assign stateControl_1 = 1'b1;



  always @(posedge clk or posedge reset)
    begin : delayMatch_process
      if (reset == 1'b1) begin
        delayMatch_reg <= {2{1'b0}};
      end
      else begin
        if (enb_1_8_0) begin
          delayMatch_reg[0] <= stateControl_1;
          delayMatch_reg[1] <= delayMatch_reg[0];
        end
      end
    end

  assign stateControl_2 = delayMatch_reg[1];



  assign enb_1_8_0_gated = stateControl_2 && enb_1_8_0;

  always @(posedge clk or posedge reset)
    begin : Pilot_Block_Length_Valid_Generator_process
      if (reset == 1'b1) begin
        count <= 6'b000000;
        countActive <= 1'b0;
        countEnd <= 1'b0;
        countEndm1 <= 1'b0;
      end
      else begin
        if (enb_1_8_0_gated) begin
          count <= count_next;
          countActive <= countActive_next;
          countEnd <= countEnd_next;
          countEndm1 <= countEndm1_next;
        end
      end
    end

  always @(count, countActive, countEnd, countEndm1, trigger) begin
    add_temp = 7'b0000000;
    t_0 = 7'b0000000;
    count_temp = count;
    countActive_next = countActive;
    if (countActive) begin
      if (count == 6'b100011) begin
        count_temp = 6'b000000;
        countActive_next = 1'b0;
      end
      else begin
        t_0 = {1'b0, count};
        add_temp = t_0 + 7'b0000001;
        if (add_temp[6] != 1'b0) begin
          count_temp = 6'b111111;
        end
        else begin
          count_temp = add_temp[5:0];
        end
      end
      countEndm1_next = count_temp == 6'b100010;
      countEnd_next = count_temp == 6'b100011;
    end
    else begin
      countEnd_next = 1'b0;
      countEndm1_next = 1'b0;
    end
    if (trigger) begin
      countActive_next = 1'b1;
    end
    endOut = countEnd;
    endOutm1_1 = countEndm1;
    validOut_1 = countActive;
    count_next = count_temp;
  end



  always @(posedge clk or posedge reset)
    begin : out1_bypass_process
      if (reset == 1'b1) begin
        endOutm1_last_value <= 1'b0;
      end
      else begin
        if (enb_1_8_0_gated) begin
          endOutm1_last_value <= endOutm1_bypass;
        end
      end
    end



  assign endOutm1_bypass = (stateControl_2 == 1'b0 ? endOutm1_last_value :
              endOutm1_1);



  assign endOutm1 = endOutm1_bypass;

  always @(posedge clk or posedge reset)
    begin : out2_bypass_process
      if (reset == 1'b1) begin
        validOut_last_value <= 1'b0;
      end
      else begin
        if (enb_1_8_0_gated) begin
          validOut_last_value <= validOut_bypass;
        end
      end
    end



  assign validOut_bypass = (stateControl_2 == 1'b0 ? validOut_last_value :
              validOut_1);



  assign validOut = validOut_bypass;

endmodule  // dvbs2hdlTransmitterCore_Pilot_Block_Length_Valid_Generator

