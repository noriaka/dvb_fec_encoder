// -------------------------------------------------------------
// 
// File Name: F:\FileFolder\DVB\dvbs2_tx_new\hdlsrc\dvbs2hdlTransmitter\dvbs2hdlTransmitterCore\dvbs2hdlTransmitterCore_BB_Header_CRC_Generator.v
// Created: 2024-01-10 13:49:57
// 
// Generated by MATLAB 23.2, HDL Coder 23.2, and Simulink 23.2
// 
// -------------------------------------------------------------


// -------------------------------------------------------------
// 
// Module: dvbs2hdlTransmitterCore_BB_Header_CRC_Generator
// Source Path: dvbs2hdlTransmitterCore/DVB-S2 Tx/BB Frame Generator/BB Header and Data CRC Generator/BB Header Generator/BB 
// Header CRC Generato
// Hierarchy Level: 6
// Model version: 4.5
// 
// CRC Generator HDL Optimized
// 
// -------------------------------------------------------------

`timescale 1 ns / 1 ns

module dvbs2hdlTransmitterCore_BB_Header_CRC_Generator
          (clk,
           reset,
           enb,
           dataIn,
           startIn,
           endIn,
           validIn,
           dataOut,
           startOut,
           endOut,
           validOut);


  input   clk;
  input   reset;
  input   enb;
  input   dataIn;
  input   startIn;
  input   endIn;
  input   validIn;
  output  dataOut;
  output  startOut;
  output  endOut;
  output  validOut;


  wire startIn_vld;
  wire endIn_vld;
  wire tstartout;
  wire processMsg;
  wire padZero;
  wire outputCRC;
  wire lastfout;
  wire validdata;
  wire [2:0] counter;  // ufix3
  wire [2:0] counter_opcrc;  // ufix3
  wire const0;  // ufix1
  wire msgenb;
  reg  datainReg;
  reg  [7:0] alpha_reg;  // ufix1 [8]
  wire dataBuffer;  // ufix1
  wire crcCheckSum_0;
  wire crcCheckSum_1;
  wire crcCheckSum_2;
  wire crcCheckSum_3;
  wire crcCheckSum_4;
  wire crcCheckSum_5;
  wire crcCheckSum_6;
  wire crcCheckSum_7;
  wire crcOut;  // ufix1
  wire msgcrc;  // ufix1
  wire tdataout;  // ufix1
  reg  dataOut_1;
  reg  startOut_1;
  reg  endOut_1;
  reg  validOut_1;


  assign startIn_vld = startIn & validIn;



  assign endIn_vld = endIn & validIn;



  dvbs2hdlTransmitterCore_CRCGenControl u_Controlsignal_inst (.clk(clk),
                                                              .reset(reset),
                                                              .enb(enb),
                                                              .startIn(startIn_vld),
                                                              .endIn(endIn_vld),
                                                              .validIn(validIn),
                                                              .startOut(tstartout),
                                                              .processMsg(processMsg),
                                                              .padZero(padZero),
                                                              .outputCRC(outputCRC),
                                                              .endOut(lastfout),
                                                              .validOut(validdata),
                                                              .counter(counter),  // ufix3
                                                              .counter_outputCRC(counter_opcrc)  // ufix3
                                                              );

  // Constant Zero
  assign const0 = 1'b0;



  assign msgenb = processMsg | padZero;



  always @(posedge clk or posedge reset)
    begin : datainput_register_process
      if (reset == 1'b1) begin
        datainReg <= 1'b0;
      end
      else begin
        if (enb) begin
          datainReg <= dataIn;
        end
      end
    end



  // Buffer Input Data
  always @(posedge clk or posedge reset)
    begin : c_process
      if (reset == 1'b1) begin
        alpha_reg <= {8{1'b0}};
      end
      else begin
        if (enb && msgenb) begin
          alpha_reg[0] <= datainReg;
          alpha_reg[32'sd7:32'sd1] <= alpha_reg[32'sd6:32'sd0];
        end
      end
    end

  assign dataBuffer = alpha_reg[7];



  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  // Select CRC output bits
  dvbs2hdlTransmitterCore_CRCGenCompute u_ComputeCRC_inst (.clk(clk),
                                                           .reset(reset),
                                                           .enb(enb),
                                                           .datainReg(datainReg),
                                                           .validIn(validIn),
                                                           .processMsg(processMsg),
                                                           .padZero(padZero),
                                                           .counter(counter),  // ufix3
                                                           .crcChecksum_0(crcCheckSum_0),
                                                           .crcChecksum_1(crcCheckSum_1),
                                                           .crcChecksum_2(crcCheckSum_2),
                                                           .crcChecksum_3(crcCheckSum_3),
                                                           .crcChecksum_4(crcCheckSum_4),
                                                           .crcChecksum_5(crcCheckSum_5),
                                                           .crcChecksum_6(crcCheckSum_6),
                                                           .crcChecksum_7(crcCheckSum_7)
                                                           );

  assign crcOut = (counter_opcrc == 3'b000 ? crcCheckSum_0 :
              (counter_opcrc == 3'b001 ? crcCheckSum_1 :
              (counter_opcrc == 3'b010 ? crcCheckSum_2 :
              (counter_opcrc == 3'b011 ? crcCheckSum_3 :
              (counter_opcrc == 3'b100 ? crcCheckSum_4 :
              (counter_opcrc == 3'b101 ? crcCheckSum_5 :
              (counter_opcrc == 3'b110 ? crcCheckSum_6 :
              crcCheckSum_7)))))));



  assign msgcrc = (outputCRC == 1'b0 ? dataBuffer :
              crcOut);



  // Output data and CRC CheckSum
  assign tdataout = (validdata == 1'b0 ? const0 :
              msgcrc);



  // Data output register
  always @(posedge clk or posedge reset)
    begin : dataOut_register_process
      if (reset == 1'b1) begin
        dataOut_1 <= 1'b0;
      end
      else begin
        if (enb) begin
          dataOut_1 <= tdataout;
        end
      end
    end



  // startOut output register
  always @(posedge clk or posedge reset)
    begin : startOut_register_process
      if (reset == 1'b1) begin
        startOut_1 <= 1'b0;
      end
      else begin
        if (enb) begin
          startOut_1 <= tstartout;
        end
      end
    end



  // endOut output register
  always @(posedge clk or posedge reset)
    begin : endout_register_process
      if (reset == 1'b1) begin
        endOut_1 <= 1'b0;
      end
      else begin
        if (enb) begin
          endOut_1 <= lastfout;
        end
      end
    end



  // validOut output register
  always @(posedge clk or posedge reset)
    begin : validout_register_process
      if (reset == 1'b1) begin
        validOut_1 <= 1'b0;
      end
      else begin
        if (enb) begin
          validOut_1 <= validdata;
        end
      end
    end



  assign dataOut = dataOut_1;

  assign startOut = startOut_1;

  assign endOut = endOut_1;

  assign validOut = validOut_1;

endmodule  // dvbs2hdlTransmitterCore_BB_Header_CRC_Generator

